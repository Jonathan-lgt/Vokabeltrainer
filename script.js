const units = {
    1: {
        name: "Unité 1",
        words: {
            1: {de: ["motiviert sein"], fr: ["être motivé", "être motivée"]},
            2: {de: ["Geschafft!", "Es ist so weit!"], fr: ["Ça y est!"]},
            3: {de: ["zurückkommen"], fr: ["revenir"]},
            4: {de: ["guter Laune sein", "gute Laune haben"], fr: ["être de bonne humeur"]},
            5: {de: ["ein Wettbewerb", "ein Preisausschreiben"], fr: ["un concours"]},
            6: {de: ["ein Praktikum", "ein Kurs"], fr: ["un stage"]},
            7: {de: ["das Karate"], fr: ["le karaté"]},
            8: {de: ["ein Autor", "eine Autorin"], fr: ["un auteur", "une auteure"]},
            9: {de: ["ein Ferienlager"], fr: ["une colonie de vacances"]},
            10: {de: ["der Berg", "das Gebirge"], fr: ["la montagne"]},
            11: {de: ["spielen"], fr: ["jouer"]},
            12: {de: ["Los geht's mit"], fr: ["C'est parti pour"]},
            13: {de: ["ein Weg"], fr: ["un chemin"]},
            14: {de: ["ein Beschluss", "ein Vorsatz"], fr: ["une résolution"]},
            15: {de: ["ein Schock", "ein Aufprall"], fr: ["un choc"]},
            16: {de: ["einen Schock versetzen"], fr: ["faire un choc"]},
            17: {de: ["die Freiheit"], fr: ["la liberté"]},
            18: {de: ["von vorn beginnen", "zurücknehmen", "wieder(auf)nehmen", "widernehmen"], fr: ["reprendre"]},
            19: {de: ["ein Pfirsich"], fr: ["une pêche"]},
            20: {de: ["aufmuntern"], fr: ["donner la pêche"]},
            21: {de: ["überhaupt nicht"], fr: ["ne...pas du tout"]},
            22: {de: ["etw. glauben", "glauben"], fr: ["croire"]},
            23: {de: ["lachen"], fr: ["rire"]},
            24: {de: ["anbieten", "schenken"], fr: ["offrir"]},
            25: {de: ["Erfolg haben", "erfolgreich sein"], fr: ["réussir"]},
            26: {de: ["ein Erfolg"], fr: ["un succès"]},
            27: {de: ["das Geld"], fr: ["l'argent"]},
            28: {de: ["sitzen bleiben"], fr: ["rester assis", "rester assise"]},
            29: {de: ["an die frische Luft gehen"], fr: ["prendre l'air"]},
            30: {de: ["sich etw. vorstellen"], fr: ["imaginer"]},
            31: {de: ["die Energie"], fr: ["l'energie"]},
            32: {de: ["ein Training"], fr: ["un entraînement"]},
            33: {de: ["mindestens", "wenigstens"], fr: ["au moins"]},
            34: {de: ["Gefahr laufen, etw. zu tun", "riskieren, etw. zu tun"], fr: ["risquer"]},
            35: {de: ["aufhören"], fr: ["arrêter"]},
            36: {de: ["besser"], fr: ["mieux"]},
            37: {de: ["die Hölle"], fr: ["l'enfer"]},
            38: {de: ["gründen", "schaffen"], fr: ["créer"]},
            39: {de: ["eine Band"], fr: ["une groupe"]},
            40: {de: ["irgendetwas", "Unsinn", "Quatsch"], fr: ["n'importe quoi"]},
            41: {de: ["realisieren", "verwirklichen"], fr: ["réaliser"]},
            42: {de: ["ein Projekt"], fr: ["un projet"]},
            43: {de: ["sich mit jdm. beschäftigen", "sich um etw. kümmern"], fr: ["s'occuper"]},
            44: {de: ["eine Anzeige", "eine Annonce"], fr: ["une Annonce"]},
            45: {de: ["ändern", "wechseln"], fr: ["changer"]},
            46: {de: ["motivieren"], fr: ["motiver"]},
            47: {de: ["teilen"], fr: ["partager"]},
            48: {de: ["eine Nummer", "eine Ausgabe"], fr: ["un numéro"]},
            49: {de: ["stressen"], fr: ["stresser"]},
            50: {de: ["das Abitur"], fr: ["le bac"]},
            51: {de: ["lügen"], fr: ["mentir"]},
            52: {de: ["nichts..."], fr: ["rien ne..."]},
            53: {de: ["niemand..."], fr: ["personne ne..."]},
            54: {de: ["einschließen"], fr: ["enfermer"]},
            55: {de: ["Es wird dir besser gehen."], fr: ["Tu vas aller mieux."]},
            56: {de: ["niemand"], fr: ["ne...personne"]},
            57: {de: ["erinnern"], fr: ["rappeler"]},
            58: {de: ["ein Refrain"], fr: ["un refrain"]},
            59: {de: ["nur", "bloß"], fr: ["juste"]},
            60: {de: ["nützen", "dienen"], fr: ["servir"]},
            61: {de: ["auch nicht"], fr: ["ne...pas non plus"]},
            62: {de: ["meiner Meinung nach"], fr: ["à mon avis"]},
            63: {de: ["deshalb"], fr: ["c'est pourquoi"]},
            64: {de: ["nur"], fr: ["seulement"]},
            65: {de: ["ein Abendessen"], fr: ["un dîner"]},

            
        }
    },
    2: {
        name: "Unité 2",
        words: {
            66: {de: ["ein Verdacht"], fr: ["un soupçon"]},
            67: {de: ["ein Jugendbuch"], fr: ["un livre pour la jeunesse"]},
            68: {de: ["ein Gegenstand"], fr: ["un objet"]},
            69: {de: ["ein Blick"], fr: ["un regard"]},
            70: {de: ["eine Frisur"], fr: ["une coiffure"]},
            71: {de: ["akzeptieren", "annehmen"], fr: ["accepter"]},
            72: {de: ["eine Decke", "ein Umschlag"], fr: ["une couverture"]},
            73: {de: ["ein Dieb", "eine Diebin"], fr: ["un voleur", "une voleuse"]},
            74: {de: ["ein System"], fr: ["un système"]},
            75: {de: ["der Durchschnitt"], fr: ["la moyenne"]},
            76: {de: ["zurückgeben"], fr: ["rendre"]},
            77: {de: ["beenden", "fertigstellen"], fr: ["terminer"]},
            78: {de: ["eine Straße", "eine Route"], fr: ["une route"]},
            79: {de: ["wenn", "als"], fr: ["losque"]},
            80: {de: ["eine Schulter"], fr: ["une épaule"]},
            81: {de: ["eifersüchtig", "neidisch"], fr: ["jaloux", "jalouse"]},
            82: {de: ["ein Eindruck"], fr: ["une impression"]},
            83: {de: ["einige"], fr: ["quelques"]},
            84: {de: ["gut drauf sein"], fr: ["avoir la pêche"]},
            85: {de: ["afrikanisch"], fr: ["africain", "africaine"]},
            86: {de: ["zeichnen"], fr: ["dessiner"]},
            87: {de: ["ermutigen"], fr: ["encourager"]},
            88: {de: ["ein Lächeln"], fr: ["un sourire"]},
            89: {de: ["hinten in", "unten in"], fr: ["au fond de"]},
            90: {de: ["eine Figur", "eine Statuette"], fr: ["une statuette"]},
            91: {de: ["verschwinden"], fr: ["disparaître"]},
            92: {de: ["berühren", "anfassen"], fr: ["toucher"]},
            93: {de: ["eine Träne"], fr: ["une larme"]},
            94: {de: ["durchsuchen", "herumkramen"], fr: ["fouiller"]},
            95: {de: ["stehlen"], fr: ["voler"]},
            96: {de: ["ein Schulleiter", "eine Schulleiterin"], fr: ["un principal", "une principale"]},
            97: {de: ["draußen", "im Freien", "Raus!"], fr: ["dehors"]},
            98: {de: ["mitbringen"], fr: ["rapporter"]},
            99: {de: ["unter"], fr: ["parmi"]},
            100: {de: ["Afrika"], fr: ["l'Afrique"]},
            101: {de: ["wütend", "zornig"], fr: ["furieux", "furieuse"]},
            102: {de: ["ausnutzen", "profitieren"], fr: ["profiter"]},
            103: {de: ["eine Entdeckung"], fr: ["une découverte"]},
            104: {de: ["schaffen, etw. zu tun"], fr: ["arriver"]},
            105: {de: ["am folgenden Tag"], fr: ["le lendemain"]},
            106: {de: ["werden"], fr: ["devenir"]},
            107: {de: ["behalten"], fr: ["garder"]},
            108: {de: ["sonst", "andernfalls"], fr: ["sinon"]},
            109: {de: ["hell", "klar"], fr: ["clair", "claire"]},
            110: {de: ["ein Fach"], fr: ["un casier"]},
            111: {de: ["eine Erlaubnis", "eine Genehmigung"], fr: ["une auorisation"]},
            112: {de: ["eine Sekunde"], fr: ["une seconde"]},
            113: {de: ["laufen", "rennen"], fr: ["courir"]},
            114: {de: ["in Gelächter ausbrechen"], fr: ["éclater de rire"]},
            115: {de: ["während"], fr: ["pendant que"]},
            116: {de: ["ein Schrank"], fr: ["une armoire"]},
            117: {de: ["zur Hälfte", "halb"], fr: ["à moitié"]},
            118: {de: ["verstecken"], fr: ["cacher"]},
            119: {de: ["in Schritt"], fr: ["un pas"]},
            120: {de: ["aus der Nähe", "von Nahem"], fr: ["de près"]},
            121: {de: ["eine Stimme"], fr: ["une Voix"]},
            122: {de: ["ein Medikament"], fr: ["un médicament"]},
            123: {de: ["verraten"], fr: ["dénoncer"]},
            124: {de: ["um etw. herum", "um jdn. herum"], fr: ["autour de qn", "autour de qc"]},
            124: {de: ["verdächtigen"], fr: ["soupçonner"]},
            125: {de: ["ein Diebstahl", "ein Raub"], fr: ["un vol"]},
            126: {de: ["jedes Mal, wenn"], fr: ["chaque fois que"]},
            127: {de: ["pâle"], fr: ["bleich"]},
            128: {de: ["verzeihen"], fr: ["pardonner"]},
            129: {de: ["anklagen"], fr: ["accuser"]},
            130: {de: ["die Polizei"], fr: ["la police"]},


        }
    },
    3: {
        name: "Unité 3",
        words: {
            11: {de: ["Hund"], fr: ["chien"]},
            12: {de: ["Katze"], fr: ["chat"]},
            13: {de: ["Vogel"], fr: ["oiseau"]},
            14: {de: ["Fisch"], fr: ["poisson"]},
            15: {de: ["Maus"], fr: ["souris"]},
        }
    },
    4: {
        name: "Unité 4",
        words: {
            16: {de: ["Auto"], fr: ["voiture"]},
            17: {de: ["Zug"], fr: ["train"]},
            18: {de: ["Fahrrad"], fr: ["vélo"]},
            19: {de: ["Bus"], fr: ["autobus"]},
            20: {de: ["Flugzeug"], fr: ["avion"]},
        }
    },
    5: {
        name: "Unité 5",
        words: {
            21: {de: ["Brot"], fr: ["pain"]},
            22: {de: ["Milch"], fr: ["lait"]},
            23: {de: ["Käse"], fr: ["fromage"]},
            24: {de: ["Fleisch"], fr: ["viande"]},
            25: {de: ["Gemüse"], fr: ["légumes"]},
        }
    },
    6: {
        name: "Unité 6",
        words: {
            26: {de: ["Schule"], fr: ["école"]},
            27: {de: ["Lehrer"], fr: ["enseignant"]},
            28: {de: ["Schüler"], fr: ["élève"]},
            29: {de: ["Buch"], fr: ["livre"]},
            30: {de: ["Tafel"], fr: ["tableau"]},
        }
    },
};

let selectedChapters = [];
let currentQuestionIndex = 0;
let currentLanguage = 'de-fr';
let questionOrder = []; // Neu für die Reihenfolge der Fragen
let currentUnitKey = null; // Um die aktuelle Unité zu speichern

function handleSelection() {
    const selection = document.getElementById("selection").value;
    const message = document.getElementById("message");
    const chapterForm = document.getElementById("chapterForm");

    if (selection === "5" || selection === "6" || selection === "7") {
        message.textContent = "Es kommen noch mehr Fragen.";
        setTimeout(() => message.textContent = "", 3000);
    } else if (selection === "8") {
        chapterForm.style.display = "block";
        message.textContent = "";
    } else {
        chapterForm.style.display = "none";
        message.textContent = "";
    }
}

function startQuiz() {
    const checkboxes = document.querySelectorAll(".chapter-box input[type='checkbox']");
    selectedChapters = [];
    checkboxes.forEach(checkbox => {
        if (checkbox.checked) {
            selectedChapters.push(checkbox.value);
        }
    });

    if (selectedChapters.length === 0) {
        document.getElementById("error-message").textContent = "Bitte wähle mindestens ein Kapitel aus.";
        return;
    }

    currentQuestionIndex = 0;
    questionOrder = []; // Neu: Reihenfolge zurücksetzen
    document.getElementById("chapterForm").style.display = "none";
    document.getElementById("quiz-container").style.display = "block";

    // Fülle die Frageordnung mit den IDs der Wörter aus den gewählten Kapiteln
    selectedChapters.forEach(chapter => {
        const wordsInChapter = units[chapter].words;
        for (let wordKey in wordsInChapter) {
            questionOrder.push(wordKey);
        }
    });

    // Mische die Fragen
    questionOrder.sort(() => Math.random() - 0.5);

    loadQuestion();
}

function loadQuestion() {
    const questionElement = document.getElementById("question");
    currentLanguage = document.getElementById("languageDirection").value;

    if (currentQuestionIndex < questionOrder.length) {
        const wordKey = questionOrder[currentQuestionIndex];
        // Finde die Unité, die das Wort enthält
        currentUnitKey = Object.keys(units).find(unit => units[unit].words[wordKey]);
        const word = units[currentUnitKey].words[wordKey];

        // Setze die Frage basierend auf der Sprachrichtung
        questionElement.textContent = currentLanguage === 'de-fr' ? word.de.join(", ") : word.fr.join(", ");
        document.getElementById("answer").value = ""; // Leert das Textfeld
    } else {
        endQuiz(); // Quiz beenden, wenn alle Fragen durch sind
    }
}

function checkAnswer() {
    const answer = document.getElementById("answer").value.trim().toLowerCase(); // Benutzereingabe in Kleinbuchstaben
    const feedbackElement = document.getElementById("feedback");
    const wordKey = questionOrder[currentQuestionIndex];
    const correctAnswers = currentLanguage === 'de-fr' ? units[currentUnitKey].words[wordKey].fr : units[currentUnitKey].words[wordKey].de;

    // Überprüfe, ob die Antwort mit einer der richtigen Lösungen übereinstimmt
    const isCorrect = correctAnswers.some(correct => answer === correct.toLowerCase());

    if (isCorrect) {
        feedbackElement.textContent = "Richtig!";
    } else {
        feedbackElement.textContent = `Falsch! Die richtige Antwort ist: ${correctAnswers.join(', ')}`;
    }

    // Meldung nach 1.3 Sekunden ausblenden und nächste Frage laden
    setTimeout(() => {
        feedbackElement.textContent = "";
        currentQuestionIndex++;
        loadQuestion(); // Nächste Frage laden
    }, 1300); // Zeit auf 1300 ms (1.3 Sekunden) gesetzt
}

function endQuiz() {
    document.getElementById("quiz-container").style.display = "none";
    const unitStatus = document.getElementById("unit-status");
    unitStatus.innerHTML = `
        <h3>Quiz beendet!</h3>
        <button onclick="goBackToSelection()">Zurück zur Auswahl</button>
    `;
}

function goBackToSelection() {
    document.getElementById("quiz-container").style.display = "none";
    document.getElementById("chapterForm").style.display = "block";
    document.getElementById("unit-status").innerHTML = ""; // Status zurücksetzen     
}
